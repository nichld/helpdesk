/* heic2any v0.0.4 - https://github.com/alexcorvi/heic2any */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(e="undefined"!=typeof globalThis?globalThis:e||self).heic2any=o()}(this,function(){"use strict";var e=/iPhone OS 1[0-9]_/.test(navigator.userAgent),o=function(e,o,t){return new Promise(function(n,r){var i=new Blob([e],{type:o});if(t&&URL.createObjectURL){var a=URL.createObjectURL(i);fetch(a).then(function(e){return e.blob()}).then(function(e){return n(e)}).catch(function(e){return r(e)})}else n(i)})};return function(t){if(void 0===t.blob&&void 0===t.toUrl&&void 0!==t.dataUrl)throw new Error("dataUrl is no longer supported. Please use `blob` option");if(void 0===t.blob&&void 0===t.toUrl)throw new Error("HEIC2ANY: No source provided. Please, provide `blob` or `toUrl` option");if(void 0===t.toType)return console.warn("HEIC2ANY: No toType provided. Destination type will be image/jpeg by default"),Object.assign({},t,{toType:"image/jpeg"});var n=void 0!==t.blob&&void 0!==t.quality||void 0!==t.multiple&&t.multiple;if(t.blob)return e&&n?function(e,t){return new Promise(function(n,r){var i=new FileReader;i.onload=function(i){var a=i.target.result;createImageBitmap(e).then(function(e){var i=document.createElement("canvas");i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0);var u=i.toDataURL(t,.8);fetch(u).then(function(e){return e.blob()}).then(function(e){return o(e,t,!0)}).then(function(e){return n(e)}).catch(function(e){return r(e)})}).catch(function(e){return r(e)})},i.readAsArrayBuffer(e)})}(t.blob,t.toType):function(e,o,t){return new Promise(function(n,r){var i=new FileReader;i.onload=function(i){for(var a=new Uint8Array(i.target.result),u=[],c=0,f=0,s=a.length;f<s;f++)255===a[f]&&218===a[f+1]&&(u.push({offset:f,type:a[f+2],size:a[f+3]}),c=f+2);if(!c||!u.length)return r(new Error("Couldn't find image data. Not a HEIC file?"));var l=12+c+5,d=a.subarray(l);return o(d,t,!0).then(function(e){return n(e)}).catch(function(e){return r(e)})},i.readAsArrayBuffer(e)})}(t.blob,o,t.toType);if(t.toUrl){var r=String(t.blob).split(",")[0].split(":")[1].split(";")[0];return function(e,o){return new Promise(function(t,n){fetch(e).then(function(e){return e.blob()}).then(function(e){return t(o({blob:e,toType:"image/png"}))}).catch(function(e){return n(e)})})}(t.blob,heic2any).then(function(e){return URL.createObjectURL(e)})}throw new Error("Invalid options provided")}});
